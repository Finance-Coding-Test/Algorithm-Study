# 문제 링크 : https://school.programmers.co.kr/learn/courses/30/lessons/273711

SELECT
    ITEMS.ITEM_ID AS 'ITEM_ID',
    ITEMS.ITEM_NAME AS 'ITEM_NAME',
    ITEMS.RARITY AS 'RARITY'
FROM
    (SELECT ITEM_ID
    FROM ITEM_INFO WHERE RARITY = 'RARE') PARENT
    INNER JOIN
    ITEM_TREE TREE
    ON TREE.PARENT_ITEM_ID = PARENT.ITEM_ID
    INNER JOIN
    (SELECT ITEM_ID, ITEM_NAME, RARITY
    FROM ITEM_INFO) ITEMS
    ON ITEMS.ITEM_ID = TREE.ITEM_ID
ORDER BY 1 DESC;
